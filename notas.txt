Uma vez registrada a venda, os seus itens n√£o podem ser modificados.

plpgsql-cursor:
https://www.postgresqltutorial.com/plpgsql-cursor/

execute format:
https://stackoverflow.com/questions/14065271/how-to-use-execute-format-using-in-postgres-function